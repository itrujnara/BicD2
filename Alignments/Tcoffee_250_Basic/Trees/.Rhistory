tree <- read.tree("../seqs_250.dnd")
library(tidyverse)
library(ggmsa)
library(ggtree)
options(ignore.negative.edge=TRUE)
tree <- read.tree("../seqs_250.dnd")
setwd("Work/BicD2/Alignments/Tcoffee_250_Basic/Trees/")
tree <- read.tree("../seqs_250.dnd")
tree$tip.label <- str_split(tree$tip.label, "|")[3]
str_split("aaa|aaa|aaa", "|")
str_split_1("aaa|aaa|aaa", "|")
str_split_1("aaa|aaa|aaa", "\|")
str_split_1("aaa|aaa|aaa", "|")
strsplit("aaa|aaa|aaa", "|")
strsplit("aaa|aaa|aaa", "\\|")
tree <- read.tree("../seqs_250.dnd")
tree$tip.label <- str_split(tree$tip.label, "\\|")[3]
tree <- read.tree("../seqs_250.dnd")
tree$tip.label <- sapply(tree$tip.label, function(x) str_split(x, "\\|")[3])
tree <- read.tree("../seqs_250.dnd")
class(tree$tip.label)
tree$tip.label <- sapply(tree$tip.label, function(x) str_split(x, "\\|")[3])
tree <- read.tree("../seqs_250.dnd")
tree$tip.label <- as.vector(sapply(tree$tip.label, function(x) str_split(x, "\\|")[3]))
tree <- read.tree("../seqs_250.dnd")
tree$tip.label <- unlist(sapply(tree$tip.label, function(x) str_split(x, "\\|")[3]))
tree <- read.tree("../seqs_250.dnd")
tree$tip.label <- as.vector(sapply(tree$tip.label, function(x) str_split(x, "\\|")[3]))
msa <- tidy_msa("../seqs_250_aligned.fa", end = 900)
msa$name <- sapply(msa$name, function(x) str_split(x, "\\|")[3])
source("~/Work/BicD2/Alignments/Tcoffee_250_Basic/Trees/test.R", echo=TRUE)
msa$name %>% as.character()
msa$name %>% as.character()
msa$name %>% as.character()
msa$name
msa <- tidy_msa("../seqs_250_aligned.fa", end = 900)
msa$name %>% as.character()
msa$name %>% as.character() %>% sapply(function(x) str_split(x, "\\|")[3])
msa$name %>% as.character()
msa$name %>% as.character() %>% sapply(function(x) str_split(x, "\\|")[3])
msa$name %>% as.character() %>% lapply(function(x) str_split(x, "\\|")[3])
msa$name %>% as.character() %>% str()
msa$name %>% as.character() %>% sapply(length)
msa$name %>% as.character()
msa$name %>% as.character() %>% str()
msa$name %>% as.character() %>% nchar()
msa$name %>% as.character() %>% strsplit("\\|")
msa$name %>% as.character() %>% strsplit("\\|")[3]
msa$name %>% as.character() %>% str_split("\\|")
msa$name %>% as.character() %>% str_split("\\|")[3]
msa$name %>% as.character() %>% str_split("\\|")
msa$name %>% as.character() %>% sapply(str_split("\\|"))
msa$name %>% as.character() %>% str_split("\\|")
msa$name %>% as.character() %>% str_split("\\|") %>% sapply(function(x) x[3])
msa$name <- msa$name %>%
as.character() %>%
str_split(x, "\\|") %>%
sapply(function(x) x[3]) %>%
as.factor()
msa$name <- msa$name %>%
as.character() %>%
str_split("\\|") %>%
sapply(function(x) x[3]) %>%
as.factor()
p <- ggtree(tree) +
geom_tiplab(aes(label = label), size = 1) +
geom_facet(data = msa, geom = geom_msa, panel = "alignment", show.legend = TRUE,
font = NULL, color = "Shapely_AA", border = "transparent") +
theme_tree2() +
labs(fill = "Amino acids", title = "Phylogeny and multiple sequence alignment
of human BicD2 homologs") +
theme(strip.background = element_blank(), strip.text.x = element_blank())
tree$tip.label %>% str_split("\\|")
tree <- read.tree("../seqs_250.dnd")
tree$tip.label %>% str_split("\\|")
tree$tip.label %>% str_split("\\|") %>% sapply(function(x) x[3])
source("~/Work/BicD2/Alignments/Tcoffee_250_Basic/Trees/test.R", echo=TRUE)
